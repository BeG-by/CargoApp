{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nvar _this = this,\n    _jsxFileName = \"D:\\\\projects\\\\cargo_app\\\\frontend\\\\src\\\\components\\\\roles\\\\manager\\\\invoices-table.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from \"react\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport TablePagination from \"@material-ui/core/TablePagination\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport WaybillDialog from \"./waybill-dialog\";\nimport { FillWaybillDialog } from \"../../parts/dialogs/fill-waybill\";\nimport { DialogWindow } from \"../../parts/dialogs/dialog\";\nimport { Typography } from \"@material-ui/core\";\nimport { InvoiceInfo } from \"./invoice-info\";\nimport CheckIcon from '@material-ui/icons/Check';\nimport fetchFieldFromObject from \"../../parts/util/function-util\";\nimport { connect } from \"react-redux\";\nimport VisibilityIcon from '@material-ui/icons/Visibility';\nimport Button from \"@material-ui/core/Button\";\nimport { DISPATCHER_INVOICES_URL, DRIVER_INVOICES_URL, handleRequestError, INVOICE_URL, makeRequest, MANAGER_INVOICES_URL } from \"../../parts/util/request-util\";\nimport useToast from \"../../parts/toast-notification/useToast\";\nimport TextSearch from \"../../parts/search/text-search\";\nimport EnhancedTableHead, { getComparator, stableSort } from \"../../parts/util/sorted-table-head\";\nimport EditIcon from '@material-ui/icons/Edit';\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport PostAddIcon from '@material-ui/icons/PostAdd';\nimport ZoomInIcon from '@material-ui/icons/ZoomIn';\nimport CloseIcon from '@material-ui/icons/Close';\nimport LibraryBooksIcon from '@material-ui/icons/LibraryBooks';\nimport InvoiceDialog from \"../dispatcher/invoice/invoice-dialog\";\nvar LEFT = \"left\";\nvar CENTER = \"center\";\nvar SIZE = 18;\nvar columns = [{\n  id: \"number\",\n  label: \"Invoice #\",\n  minWidth: 100,\n  align: LEFT,\n  fontSize: SIZE\n}, {\n  id: \"status\",\n  label: \"Status\",\n  minWidth: 100,\n  align: CENTER,\n  fontSize: SIZE\n}, {\n  id: \"registrationDate\",\n  label: \"Date of registration\",\n  minWidth: 150,\n  align: LEFT,\n  fontSize: SIZE\n}, {\n  id: \"shipper\",\n  label: \"Shipper\",\n  minWidth: 300,\n  align: LEFT,\n  fontSize: SIZE\n}, {\n  id: \"consignee\",\n  label: \"Consignee\",\n  minWidth: 300,\n  align: LEFT,\n  fontSize: SIZE\n}, {\n  id: \"waybill\",\n  label: \"Waybill\",\n  minWidth: 100,\n  align: CENTER,\n  fontSize: SIZE\n}];\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    role: store.user.roles[0]\n  };\n};\n\nvar convertShipperAndConsigneeToStringInInvoices = function convertShipperAndConsigneeToStringInInvoices(invoices) {\n  for (var i = 0; i < invoices.length; i++) {\n    invoices[i] = convertShipperAndConsigneeToString(invoices[i]);\n  }\n\n  return invoices;\n};\n\nvar convertShipperAndConsigneeToString = function convertShipperAndConsigneeToString(invoice) {\n  var shipperAddress = invoice.shipper.address;\n  var consigneeAddress = invoice.consignee.address;\n  return _objectSpread(_objectSpread({}, invoice), {}, {\n    shipper: shipperAddress.country + \" \" + shipperAddress.city + \" \" + shipperAddress.street + \"  \" + shipperAddress.house,\n    consignee: consigneeAddress.country + \" \" + consigneeAddress.city + \" \" + consigneeAddress.street + \" \" + consigneeAddress.house\n  });\n};\n\nexport var InvoicesTable = connect(mapStateToProps)(function (props) {\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      page = _useState2[0],\n      setPage = _useState2[1];\n\n  var _useState3 = useState(10),\n      _useState4 = _slicedToArray(_useState3, 2),\n      rowsPerPage = _useState4[0],\n      setRowsPerPage = _useState4[1];\n\n  var _useState5 = useState(0),\n      _useState6 = _slicedToArray(_useState5, 2),\n      totalInvoicesAmount = _useState6[0],\n      setTotalInvoicesAmount = _useState6[1];\n\n  var _useToast = useToast(),\n      _useToast2 = _slicedToArray(_useToast, 2),\n      ToastComponent = _useToast2[0],\n      openToast = _useToast2[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      invoices = _useState8[0],\n      setInvoices = _useState8[1];\n\n  var _useState9 = useState({\n    id: 0,\n    waybill: null,\n    invoiceStatus: \"\",\n    number: \"\"\n  }),\n      _useState10 = _slicedToArray(_useState9, 2),\n      invoice = _useState10[0],\n      setInvoice = _useState10[1];\n\n  var _useState11 = useState(null),\n      _useState12 = _slicedToArray(_useState11, 2),\n      form = _useState12[0],\n      setForm = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      waybillFillDialogOpen = _useState14[0],\n      setWaybillFillDialogOpen = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      waybillDialogOpen = _useState16[0],\n      setWaybillDialogOpen = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      invoiceInfoDialogOpen = _useState18[0],\n      setInvoiceInfoDialogOpen = _useState18[1];\n\n  var role = props.role;\n\n  var _React$useState = React.useState('asc'),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      order = _React$useState2[0],\n      setOrder = _React$useState2[1];\n\n  var _React$useState3 = React.useState('status'),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      orderBy = _React$useState4[0],\n      setOrderBy = _React$useState4[1];\n\n  var _useState19 = useState(false),\n      _useState20 = _slicedToArray(_useState19, 2),\n      invoiceDialogEditOpen = _useState20[0],\n      setInvoiceDialogEditOpen = _useState20[1];\n\n  var _useState21 = useState(false),\n      _useState22 = _slicedToArray(_useState21, 2),\n      selectedId = _useState22[0],\n      setSelectedId = _useState22[1];\n\n  var handleRequestSort = function handleRequestSort(event, property) {\n    var isAsc = orderBy === property && order === 'asc';\n    setOrder(isAsc ? 'desc' : 'asc');\n    setOrderBy(property);\n  };\n\n  function fetchInvoices() {\n    var cleanupFunction,\n        currentPage,\n        currentRowsPerPage,\n        invoiceNumber,\n        params,\n        _args = arguments;\n    return _regeneratorRuntime.async(function fetchInvoices$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            cleanupFunction = _args.length > 0 && _args[0] !== undefined ? _args[0] : false;\n            currentPage = _args.length > 1 && _args[1] !== undefined ? _args[1] : page;\n            currentRowsPerPage = _args.length > 2 && _args[2] !== undefined ? _args[2] : rowsPerPage;\n            invoiceNumber = _args.length > 3 && _args[3] !== undefined ? _args[3] : \"\";\n\n            if (cleanupFunction) {\n              _context.next = 29;\n              break;\n            }\n\n            params = \"?requestedPage=\" + currentPage + \"&invoicesPerPage=\" + currentRowsPerPage;\n\n            if (invoiceNumber !== \"\") {\n              params += \"&number=\" + invoiceNumber;\n            }\n\n            _context.prev = 7;\n            _context.t0 = role;\n            _context.next = _context.t0 === \"MANAGER\" ? 11 : _context.t0 === \"DRIVER\" ? 14 : _context.t0 === \"DISPATCHER\" ? 17 : _context.t0 === \"OWNER\" ? 20 : 23;\n            break;\n\n          case 11:\n            _context.next = 13;\n            return _regeneratorRuntime.awrap(fetchInvoicesForManager(params));\n\n          case 13:\n            return _context.abrupt(\"break\", 23);\n\n          case 14:\n            _context.next = 16;\n            return _regeneratorRuntime.awrap(fetchInvoicesForDriver(params));\n\n          case 16:\n            return _context.abrupt(\"break\", 23);\n\n          case 17:\n            _context.next = 19;\n            return _regeneratorRuntime.awrap(fetchInvoicesForDispatcher(params));\n\n          case 19:\n            return _context.abrupt(\"break\", 23);\n\n          case 20:\n            _context.next = 22;\n            return _regeneratorRuntime.awrap(fetchInvoicesForOwner(params));\n\n          case 22:\n            return _context.abrupt(\"break\", 23);\n\n          case 23:\n            _context.next = 29;\n            break;\n\n          case 25:\n            _context.prev = 25;\n            _context.t1 = _context[\"catch\"](7);\n            setInvoices([]);\n            handleRequestError(_context.t1, openToast);\n\n          case 29:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[7, 25]], Promise);\n  }\n\n  var fetchInvoicesForManager = function fetchInvoicesForManager(params) {\n    var response;\n    return _regeneratorRuntime.async(function fetchInvoicesForManager$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(makeRequest(\"GET\", \"\" + MANAGER_INVOICES_URL + params));\n\n          case 2:\n            response = _context2.sent;\n            setTotalInvoicesAmount(response.data.totalAmount);\n            setInvoices(convertShipperAndConsigneeToStringInInvoices(response.data.invoices));\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var fetchInvoicesForDriver = function fetchInvoicesForDriver(params) {\n    var response;\n    return _regeneratorRuntime.async(function fetchInvoicesForDriver$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return _regeneratorRuntime.awrap(makeRequest(\"GET\", \"\" + DRIVER_INVOICES_URL + params));\n\n          case 2:\n            response = _context3.sent;\n            setTotalInvoicesAmount(response.data.totalAmount);\n            setInvoices(convertShipperAndConsigneeToStringInInvoices(response.data.invoices));\n\n          case 5:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var fetchInvoicesForDispatcher = function fetchInvoicesForDispatcher(params) {\n    var response;\n    return _regeneratorRuntime.async(function fetchInvoicesForDispatcher$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return _regeneratorRuntime.awrap(makeRequest(\"GET\", \"\" + DISPATCHER_INVOICES_URL + params));\n\n          case 2:\n            response = _context4.sent;\n            setTotalInvoicesAmount(response.data.totalAmount);\n            setInvoices(convertShipperAndConsigneeToStringInInvoices(response.data.invoices));\n\n          case 5:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var fetchInvoicesForOwner = function fetchInvoicesForOwner(params) {\n    var response;\n    return _regeneratorRuntime.async(function fetchInvoicesForOwner$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            _context5.next = 2;\n            return _regeneratorRuntime.awrap(makeRequest(\"GET\", \"\" + INVOICE_URL + params));\n\n          case 2:\n            response = _context5.sent;\n            setTotalInvoicesAmount(response.data.totalAmount);\n            setInvoices(convertShipperAndConsigneeToStringInInvoices(response.data.invoices));\n\n          case 5:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    var cleanupFunction = false;\n    fetchInvoices(cleanupFunction);\n    return function () {\n      return cleanupFunction = true;\n    };\n  }, [role]);\n\n  var handleChangePage = function handleChangePage(event, newPage) {\n    setPage(newPage);\n    fetchInvoices(false, newPage);\n  };\n\n  var handleTableRowClick = function handleTableRowClick(invoice) {\n    setInvoice(invoice);\n    handleInvoiceInfoOpen(invoice.id);\n  };\n\n  var handleInvoiceEdit = function handleInvoiceEdit(id) {\n    setSelectedId(id);\n    setInvoiceDialogEditOpen(true);\n  };\n\n  var handleClose = function handleClose() {\n    setWaybillFillDialogOpen(false);\n    setInvoiceInfoDialogOpen(false);\n    setWaybillDialogOpen(false);\n    fetchInvoices(false);\n  };\n\n  var handleInvoiceInfoOpen = function handleInvoiceInfoOpen(id) {\n    setForm(React.createElement(InvoiceInfo, {\n      invoiceId: id,\n      onClose: handleClose,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 17\n      }\n    }));\n    setWaybillFillDialogOpen(false);\n    setInvoiceInfoDialogOpen(true);\n  };\n\n  var handleWaybillFormOpen = function handleWaybillFormOpen() {\n    setWaybillFillDialogOpen(false);\n    setWaybillDialogOpen(true);\n  };\n\n  var handleChangeRowsPerPage = function handleChangeRowsPerPage(event) {\n    setRowsPerPage(+event.target.value);\n    setPage(0);\n    fetchInvoices(false, 0, +event.target.value);\n  };\n\n  var handleSearchFieldChange = function handleSearchFieldChange(searchNumber) {\n    setPage(0);\n    fetchInvoices(false, 0, rowsPerPage, searchNumber);\n  };\n\n  var handleWaybillFillClick = function handleWaybillFillClick(invoice) {\n    setInvoice(invoice);\n    setForm(FillWaybillDialog(handleWaybillFormOpen, handleClose));\n    setWaybillFillDialogOpen(true);\n  };\n\n  return React.createElement(\"main\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 13\n    }\n  }, React.createElement(Paper, {\n    className: \"table-paper main-table-paper\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 17\n    }\n  }, React.createElement(\"div\", {\n    className: \"table-header-wrapper\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 21\n    }\n  }, React.createElement(Typography, {\n    variant: \"button\",\n    display: \"block\",\n    gutterBottom: true,\n    style: {\n      fontSize: 26,\n      marginLeft: 15,\n      marginTop: 15,\n      textDecoration: \"underline\"\n    },\n    className: \"table-title\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 25\n    }\n  }, React.createElement(LibraryBooksIcon, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 29\n    }\n  }), \"Invoices\"), React.createElement(TextSearch, {\n    onFieldChange: handleSearchFieldChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 25\n    }\n  })), React.createElement(TableContainer, {\n    className: \"table-container\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 21\n    }\n  }, React.createElement(Table, {\n    \"aria-label\": \"sticky table\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 25\n    }\n  }, React.createElement(EnhancedTableHead, {\n    firstMenu: true,\n    secondMenu: true,\n    columns: columns,\n    order: order,\n    orderBy: orderBy,\n    onRequestSort: handleRequestSort,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 29\n    }\n  }), React.createElement(TableBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 29\n    }\n  }, stableSort(invoices, getComparator(order, orderBy)).map(function (invoice) {\n    return React.createElement(TableRow, {\n      hover: true,\n      role: \"checkbox\",\n      tabIndex: -1,\n      key: invoice.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 45\n      }\n    }, React.createElement(TableCell, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 49\n      }\n    }, invoice.status === \"REJECTED\" && role === \"DISPATCHER\" ? React.createElement(Tooltip, {\n      title: \"Click to edit invoice\",\n      arrow: true,\n      className: \"table-delete-edit-div\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 59\n      }\n    }, React.createElement(Button, {\n      className: \"menu-table-btn\",\n      color: \"secondary\",\n      startIcon: React.createElement(EditIcon, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 76\n        }\n      }),\n      onClick: function onClick(e) {\n        e.stopPropagation();\n        handleInvoiceEdit(invoice.id);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 61\n      }\n    })) : invoice.status === \"ACCEPTED\" && invoice.waybill === null && role === \"MANAGER\" ? React.createElement(Tooltip, {\n      title: \"Click to fill in waybill\",\n      arrow: true,\n      className: \"table-delete-edit-div\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 63\n      }\n    }, React.createElement(Button, {\n      className: \"menu-table-btn\",\n      color: \"primary\",\n      startIcon: React.createElement(PostAddIcon, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 80\n        }\n      }),\n      onClick: function onClick(e) {\n        e.stopPropagation();\n        handleWaybillFillClick(invoice);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 65\n      }\n    })) : invoice.status === \"REGISTERED\" && role === \"MANAGER\" ? React.createElement(Tooltip, {\n      title: \"Click to verify invoice\",\n      arrow: true,\n      className: \"table-delete-edit-div\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 67\n      }\n    }, React.createElement(Button, {\n      className: \"menu-table-btn\",\n      color: \"secondary\",\n      startIcon: React.createElement(ZoomInIcon, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 84\n        }\n      }),\n      onClick: function onClick(e) {\n        e.stopPropagation();\n        handleTableRowClick(invoice);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 69\n      }\n    })) : invoice.status === \"ACCEPTED\" && invoice.waybill !== null && role === \"DRIVER\" ? React.createElement(Tooltip, {\n      title: \"Click to close invoice\",\n      arrow: true,\n      className: \"table-delete-edit-div\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 71\n      }\n    }, React.createElement(Button, {\n      className: \"menu-table-btn\",\n      color: \"secondary\",\n      startIcon: React.createElement(CloseIcon, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 88\n        }\n      }),\n      onClick: function onClick(e) {\n        e.stopPropagation();\n        handleTableRowClick(invoice);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 73\n      }\n    })) : null), columns.map(function (column) {\n      var value = fetchFieldFromObject(invoice, column.id);\n      return React.createElement(TableCell, {\n        key: column.id,\n        align: column.align,\n        style: {\n          minWidth: column.minWidth,\n          maxWidth: column.maxWidth\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 57\n        }\n      }, column.id === 'waybill' && value !== null ? React.createElement(CheckIcon, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 67\n        }\n      }) : column.id === \"status\" && value === \"ACCEPTED\" ? React.createElement(\"div\", {\n        style: {\n          color: \"royalblue\",\n          border: \"1px solid royalblue\",\n          padding: 3,\n          borderRadius: 5\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 71\n        }\n      }, value) : column.id === \"status\" && value === \"REGISTERED\" ? React.createElement(\"div\", {\n        style: {\n          color: \"green\",\n          border: \"1px solid green\",\n          padding: 3,\n          borderRadius: 5\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 75\n        }\n      }, value) : column.id === \"status\" && value === \"REJECTED\" ? React.createElement(\"div\", {\n        style: {\n          color: \"crimson\",\n          border: \"1px solid crimson\",\n          padding: 3,\n          borderRadius: 5\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 79\n        }\n      }, value) : column.id === \"status\" && (value === \"CLOSED\" || value === \"CLOSED_WITH_ACT\") ? React.createElement(\"div\", {\n        style: {\n          color: \"black\",\n          border: \"1px solid black\",\n          padding: 3,\n          borderRadius: 5\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 83\n        }\n      }, value) : value);\n    }), React.createElement(TableCell, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 49\n      }\n    }, React.createElement(Tooltip, {\n      title: \"Click to see invoice info\",\n      arrow: true,\n      className: \"table-delete-edit-div\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 53\n      }\n    }, React.createElement(Button, {\n      className: \"menu-table-btn\",\n      color: \"primary\",\n      startIcon: React.createElement(VisibilityIcon, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 72\n        }\n      }),\n      onClick: function onClick(e) {\n        e.stopPropagation();\n        handleTableRowClick(invoice);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 57\n      }\n    }))));\n  })))), React.createElement(TablePagination, {\n    rowsPerPageOptions: [10, 20, 50],\n    component: \"div\",\n    count: totalInvoicesAmount,\n    rowsPerPage: rowsPerPage,\n    page: page,\n    onChangePage: handleChangePage,\n    onChangeRowsPerPage: handleChangeRowsPerPage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 384,\n      columnNumber: 17\n    }\n  }), React.createElement(WaybillDialog, {\n    invoice: invoice,\n    open: waybillDialogOpen,\n    onClose: function onClose() {\n      setWaybillDialogOpen(false);\n    },\n    onSave: function onSave() {\n      fetchInvoices(false).catch(function (err) {\n        setInvoices([]);\n        handleRequestError(err);\n      });\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 21\n    }\n  }), React.createElement(DialogWindow, {\n    dialogTitle: \"Confirmation\",\n    handleClose: handleClose,\n    openDialog: waybillFillDialogOpen,\n    form: form,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 21\n    }\n  }), React.createElement(DialogWindow, {\n    dialogTitle: \"Invoice # \" + invoice.number,\n    fullWidth: true,\n    maxWidth: \"xl\",\n    handleClose: handleClose,\n    openDialog: invoiceInfoDialogOpen,\n    form: form,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 416,\n      columnNumber: 21\n    }\n  }), React.createElement(InvoiceDialog, {\n    invoiceId: selectedId,\n    open: invoiceDialogEditOpen,\n    onClose: function onClose() {\n      setInvoiceDialogEditOpen(false);\n      fetchInvoices();\n    },\n    openToast: openToast,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 21\n    }\n  })), ToastComponent);\n});\nexport default InvoicesTable;","map":{"version":3,"sources":["D:/projects/cargo_app/frontend/src/components/roles/manager/invoices-table.js"],"names":["React","useEffect","useState","Paper","Table","TableBody","TableCell","TableContainer","TablePagination","TableRow","WaybillDialog","FillWaybillDialog","DialogWindow","Typography","InvoiceInfo","CheckIcon","fetchFieldFromObject","connect","VisibilityIcon","Button","DISPATCHER_INVOICES_URL","DRIVER_INVOICES_URL","handleRequestError","INVOICE_URL","makeRequest","MANAGER_INVOICES_URL","useToast","TextSearch","EnhancedTableHead","getComparator","stableSort","EditIcon","Tooltip","PostAddIcon","ZoomInIcon","CloseIcon","LibraryBooksIcon","InvoiceDialog","LEFT","CENTER","SIZE","columns","id","label","minWidth","align","fontSize","mapStateToProps","store","role","user","roles","convertShipperAndConsigneeToStringInInvoices","invoices","i","length","convertShipperAndConsigneeToString","invoice","shipperAddress","shipper","address","consigneeAddress","consignee","country","city","street","house","InvoicesTable","props","page","setPage","rowsPerPage","setRowsPerPage","totalInvoicesAmount","setTotalInvoicesAmount","ToastComponent","openToast","setInvoices","waybill","invoiceStatus","number","setInvoice","form","setForm","waybillFillDialogOpen","setWaybillFillDialogOpen","waybillDialogOpen","setWaybillDialogOpen","invoiceInfoDialogOpen","setInvoiceInfoDialogOpen","order","setOrder","orderBy","setOrderBy","invoiceDialogEditOpen","setInvoiceDialogEditOpen","selectedId","setSelectedId","handleRequestSort","event","property","isAsc","fetchInvoices","cleanupFunction","currentPage","currentRowsPerPage","invoiceNumber","params","fetchInvoicesForManager","fetchInvoicesForDriver","fetchInvoicesForDispatcher","fetchInvoicesForOwner","response","data","totalAmount","handleChangePage","newPage","handleTableRowClick","handleInvoiceInfoOpen","handleInvoiceEdit","handleClose","handleWaybillFormOpen","handleChangeRowsPerPage","target","value","handleSearchFieldChange","searchNumber","handleWaybillFillClick","marginLeft","marginTop","textDecoration","map","status","e","stopPropagation","column","maxWidth","color","border","padding","borderRadius","catch","err"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Table from \"@material-ui/core/Table\";\r\nimport TableBody from \"@material-ui/core/TableBody\";\r\nimport TableCell from \"@material-ui/core/TableCell\";\r\nimport TableContainer from \"@material-ui/core/TableContainer\";\r\nimport TablePagination from \"@material-ui/core/TablePagination\";\r\nimport TableRow from \"@material-ui/core/TableRow\";\r\nimport WaybillDialog from \"./waybill-dialog\";\r\nimport {FillWaybillDialog} from \"../../parts/dialogs/fill-waybill\";\r\nimport {DialogWindow} from \"../../parts/dialogs/dialog\";\r\nimport {Typography} from \"@material-ui/core\";\r\nimport {InvoiceInfo} from \"./invoice-info\";\r\nimport CheckIcon from '@material-ui/icons/Check';\r\nimport fetchFieldFromObject from \"../../parts/util/function-util\";\r\nimport {connect} from \"react-redux\";\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {\r\n    DISPATCHER_INVOICES_URL,\r\n    DRIVER_INVOICES_URL,\r\n    handleRequestError, INVOICE_URL,\r\n    makeRequest,\r\n    MANAGER_INVOICES_URL\r\n} from \"../../parts/util/request-util\";\r\nimport useToast from \"../../parts/toast-notification/useToast\";\r\nimport TextSearch from \"../../parts/search/text-search\";\r\nimport EnhancedTableHead, {getComparator, stableSort} from \"../../parts/util/sorted-table-head\";\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport PostAddIcon from '@material-ui/icons/PostAdd';\r\nimport ZoomInIcon from '@material-ui/icons/ZoomIn';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport LibraryBooksIcon from '@material-ui/icons/LibraryBooks';\r\nimport InvoiceDialog from \"../dispatcher/invoice/invoice-dialog\";\r\n\r\nconst LEFT = \"left\";\r\nconst CENTER = \"center\";\r\nconst SIZE = 18;\r\n\r\nconst columns = [\r\n    {id: \"number\", label: \"Invoice #\", minWidth: 100, align: LEFT, fontSize: SIZE},\r\n    {id: \"status\", label: \"Status\", minWidth: 100, align: CENTER, fontSize: SIZE},\r\n    {id: \"registrationDate\", label: \"Date of registration\", minWidth: 150, align: LEFT, fontSize: SIZE},\r\n    {id: \"shipper\", label: \"Shipper\", minWidth: 300, align: LEFT, fontSize: SIZE},\r\n    {id: \"consignee\", label: \"Consignee\", minWidth: 300, align: LEFT, fontSize: SIZE},\r\n    {id: \"waybill\", label: \"Waybill\", minWidth: 100, align: CENTER, fontSize: SIZE}\r\n];\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        role: store.user.roles[0]\r\n    }\r\n};\r\n\r\nconst convertShipperAndConsigneeToStringInInvoices = (invoices) => {\r\n    for (let i = 0; i < invoices.length; i++) {\r\n        invoices[i] = convertShipperAndConsigneeToString(invoices[i]);\r\n    }\r\n    return invoices;\r\n}\r\n\r\nconst convertShipperAndConsigneeToString = (invoice) => {\r\n    let shipperAddress = invoice.shipper.address;\r\n    let consigneeAddress = invoice.consignee.address;\r\n    return {\r\n        ...invoice,\r\n        shipper: `${shipperAddress.country} ${shipperAddress.city} ${shipperAddress.street}  ${shipperAddress.house}`,\r\n        consignee: `${consigneeAddress.country} ${consigneeAddress.city} ${consigneeAddress.street} ${consigneeAddress.house}`\r\n    };\r\n}\r\n\r\n\r\nexport const InvoicesTable = connect(mapStateToProps)((props) => {\r\n    const [page, setPage] = useState(0);\r\n    const [rowsPerPage, setRowsPerPage] = useState(10);\r\n    const [totalInvoicesAmount, setTotalInvoicesAmount] = useState(0);\r\n\r\n    const [ToastComponent, openToast] = useToast();\r\n    const [invoices, setInvoices] = useState([]);\r\n    const [invoice, setInvoice] = useState({id: 0, waybill: null, invoiceStatus: \"\", number: \"\"});\r\n    const [form, setForm] = useState(null);\r\n    const [waybillFillDialogOpen, setWaybillFillDialogOpen] = useState(false);\r\n    const [waybillDialogOpen, setWaybillDialogOpen] = useState(false);\r\n    const [invoiceInfoDialogOpen, setInvoiceInfoDialogOpen] = useState(false);\r\n    const role = props.role;\r\n    const [order, setOrder] = React.useState('asc');\r\n    const [orderBy, setOrderBy] = React.useState('status');\r\n    const [invoiceDialogEditOpen, setInvoiceDialogEditOpen] = useState(false);\r\n    const [selectedId, setSelectedId] = useState(false);\r\n\r\n    const handleRequestSort = (event, property) => {\r\n        const isAsc = orderBy === property && order === 'asc';\r\n        setOrder(isAsc ? 'desc' : 'asc');\r\n        setOrderBy(property);\r\n    };\r\n\r\n    async function fetchInvoices(cleanupFunction = false,\r\n                                 currentPage = page,\r\n                                 currentRowsPerPage = rowsPerPage,\r\n                                 invoiceNumber = \"\") {\r\n\r\n        if (!cleanupFunction) {\r\n            let params = `?requestedPage=${currentPage}&invoicesPerPage=${currentRowsPerPage}`;\r\n            if (invoiceNumber !== \"\") {\r\n                params += `&number=${invoiceNumber}`;\r\n            }\r\n            try {\r\n                switch (role) {\r\n                    case \"MANAGER\":\r\n                        await fetchInvoicesForManager(params);\r\n                        break;\r\n                    case \"DRIVER\":\r\n                        await fetchInvoicesForDriver(params);\r\n                        break;\r\n                    case \"DISPATCHER\":\r\n                        await fetchInvoicesForDispatcher(params);\r\n                        break;\r\n                    case \"OWNER\":\r\n                        await fetchInvoicesForOwner(params);\r\n                        break;\r\n                }\r\n            } catch (err) {\r\n                setInvoices([]);\r\n                handleRequestError(err, openToast);\r\n            }\r\n        }\r\n    }\r\n\r\n    const fetchInvoicesForManager = async (params) => {\r\n        let response = await makeRequest(\"GET\", `${MANAGER_INVOICES_URL}${params}`);\r\n        setTotalInvoicesAmount(response.data.totalAmount);\r\n        setInvoices(convertShipperAndConsigneeToStringInInvoices(response.data.invoices));\r\n    };\r\n\r\n    const fetchInvoicesForDriver = async (params) => {\r\n        let response = await makeRequest(\"GET\", `${DRIVER_INVOICES_URL}${params}`);\r\n        setTotalInvoicesAmount(response.data.totalAmount);\r\n        setInvoices(convertShipperAndConsigneeToStringInInvoices(response.data.invoices));\r\n    };\r\n\r\n    const fetchInvoicesForDispatcher = async (params) => {\r\n        let response = await makeRequest(\"GET\", `${DISPATCHER_INVOICES_URL}${params}`);\r\n        setTotalInvoicesAmount(response.data.totalAmount);\r\n        setInvoices(convertShipperAndConsigneeToStringInInvoices(response.data.invoices));\r\n    };\r\n\r\n    const fetchInvoicesForOwner = async (params) => {\r\n        let response = await makeRequest(\"GET\", `${INVOICE_URL}${params}`);\r\n        setTotalInvoicesAmount(response.data.totalAmount);\r\n        setInvoices(convertShipperAndConsigneeToStringInInvoices(response.data.invoices));\r\n    };\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        let cleanupFunction = false;\r\n        fetchInvoices(cleanupFunction)\r\n        return () => cleanupFunction = true;\r\n    }, [role]);\r\n\r\n    const handleChangePage = (event, newPage) => {\r\n        setPage(newPage);\r\n        fetchInvoices(false, newPage)\r\n    };\r\n\r\n    const handleTableRowClick = (invoice) => {\r\n        setInvoice(invoice);\r\n        handleInvoiceInfoOpen(invoice.id);\r\n    };\r\n\r\n    const handleInvoiceEdit = (id) => {\r\n        setSelectedId(id);\r\n        setInvoiceDialogEditOpen(true);\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setWaybillFillDialogOpen(false);\r\n        setInvoiceInfoDialogOpen(false);\r\n        setWaybillDialogOpen(false);\r\n        fetchInvoices(false);\r\n    };\r\n\r\n    const handleInvoiceInfoOpen = (id) => {\r\n        setForm(<InvoiceInfo invoiceId={id} onClose={handleClose}/>);\r\n        setWaybillFillDialogOpen(false);\r\n        setInvoiceInfoDialogOpen(true);\r\n    };\r\n\r\n    const handleWaybillFormOpen = () => {\r\n        setWaybillFillDialogOpen(false);\r\n        setWaybillDialogOpen(true);\r\n    };\r\n\r\n    const handleChangeRowsPerPage = (event) => {\r\n        setRowsPerPage(+event.target.value);\r\n        setPage(0);\r\n        fetchInvoices(false, 0, +event.target.value)\r\n    };\r\n\r\n    const handleSearchFieldChange = (searchNumber) => {\r\n        setPage(0);\r\n        fetchInvoices(false, 0, rowsPerPage, searchNumber);\r\n    };\r\n\r\n    const handleWaybillFillClick = (invoice) => {\r\n        setInvoice(invoice);\r\n        setForm(FillWaybillDialog(handleWaybillFormOpen, handleClose));\r\n        setWaybillFillDialogOpen(true);\r\n    }\r\n\r\n\r\n    return (\r\n            <main>\r\n                <Paper className=\"table-paper main-table-paper\">\r\n                    <div className=\"table-header-wrapper\">\r\n                        <Typography variant=\"button\" display=\"block\" gutterBottom\r\n                                    style={{fontSize: 26, marginLeft: 15, marginTop: 15, textDecoration: \"underline\"}}\r\n                                    className=\"table-title\"\r\n                        >\r\n                            <LibraryBooksIcon/>\r\n                            Invoices\r\n                        </Typography>\r\n                        <TextSearch\r\n                            onFieldChange={handleSearchFieldChange}\r\n                        />\r\n                    </div>\r\n\r\n                    <TableContainer className=\"table-container\">\r\n                        <Table aria-label=\"sticky table\">\r\n                            <EnhancedTableHead\r\n                                firstMenu={true}\r\n                                secondMenu={true}\r\n                                columns={columns}\r\n                                order={order}\r\n                                orderBy={orderBy}\r\n                                onRequestSort={handleRequestSort}\r\n                            />\r\n                            <TableBody>\r\n                                {stableSort(invoices, getComparator(order, orderBy))\r\n                                    .map((invoice) => {\r\n                                        return (\r\n                                            <TableRow\r\n                                                hover\r\n                                                role=\"checkbox\"\r\n                                                tabIndex={-1}\r\n                                                key={invoice.id}\r\n                                            >\r\n                                                <TableCell>\r\n                                                    {invoice.status === \"REJECTED\"\r\n                                                    && role === \"DISPATCHER\"\r\n                                                        ? <Tooltip title=\"Click to edit invoice\"\r\n                                                                   arrow\r\n                                                                   className=\"table-delete-edit-div\">\r\n                                                            <Button\r\n                                                                className=\"menu-table-btn\"\r\n                                                                color={\"secondary\"}\r\n                                                                startIcon={<EditIcon/>}\r\n                                                                onClick={(e) => {\r\n                                                                    e.stopPropagation();\r\n                                                                    handleInvoiceEdit(invoice.id);\r\n                                                                }}/>\r\n                                                        </Tooltip>\r\n                                                        : invoice.status === \"ACCEPTED\"\r\n                                                        && invoice.waybill === null\r\n                                                        && role === \"MANAGER\"\r\n                                                            ? <Tooltip title=\"Click to fill in waybill\"\r\n                                                                       arrow\r\n                                                                       className=\"table-delete-edit-div\">\r\n                                                                <Button\r\n                                                                    className=\"menu-table-btn\"\r\n                                                                    color={\"primary\"}\r\n                                                                    startIcon={<PostAddIcon/>}\r\n                                                                    onClick={(e) => {\r\n                                                                        e.stopPropagation();\r\n                                                                        handleWaybillFillClick(invoice);\r\n                                                                    }}/>\r\n                                                            </Tooltip>\r\n                                                            : invoice.status === \"REGISTERED\"\r\n                                                            && role === \"MANAGER\"\r\n                                                                ? <Tooltip title=\"Click to verify invoice\"\r\n                                                                           arrow\r\n                                                                           className=\"table-delete-edit-div\">\r\n                                                                    <Button\r\n                                                                        className=\"menu-table-btn\"\r\n                                                                        color={\"secondary\"}\r\n                                                                        startIcon={<ZoomInIcon/>}\r\n                                                                        onClick={(e) => {\r\n                                                                            e.stopPropagation();\r\n                                                                            handleTableRowClick(invoice);\r\n                                                                        }}/>\r\n                                                                </Tooltip>\r\n                                                                : invoice.status === \"ACCEPTED\"\r\n                                                                && invoice.waybill !== null\r\n                                                                && role === \"DRIVER\"\r\n                                                                    // && invoice.checkPassage //fixme проверить возможность закрытия\r\n                                                                    ? <Tooltip title=\"Click to close invoice\"\r\n                                                                               arrow\r\n                                                                               className=\"table-delete-edit-div\">\r\n                                                                        <Button\r\n                                                                            className=\"menu-table-btn\"\r\n                                                                            color={\"secondary\"}\r\n                                                                            startIcon={<CloseIcon/>}\r\n                                                                            onClick={(e) => {\r\n                                                                                e.stopPropagation();\r\n                                                                                handleTableRowClick(invoice)\r\n                                                                            }}/>\r\n                                                                    </Tooltip>\r\n                                                                    : null\r\n                                                    }\r\n                                                </TableCell>\r\n                                                {columns.map((column) => {\r\n                                                    const value = fetchFieldFromObject(invoice, column.id);\r\n                                                    return (\r\n                                                        <TableCell key={column.id}\r\n                                                                   align={column.align}\r\n                                                                   style={{\r\n                                                                       minWidth: column.minWidth,\r\n                                                                       maxWidth: column.maxWidth\r\n                                                                   }}>\r\n                                                            {column.id === 'waybill'\r\n                                                            && value !== null\r\n                                                                ? <CheckIcon/>\r\n                                                                : column.id === \"status\"\r\n                                                                && value === \"ACCEPTED\"\r\n                                                                    ? <div style={{\r\n                                                                        color: \"royalblue\",\r\n                                                                        border: \"1px solid royalblue\",\r\n                                                                        padding: 3,\r\n                                                                        borderRadius: 5\r\n                                                                    }}>{value}</div>\r\n                                                                    : column.id === \"status\"\r\n                                                                    && value === \"REGISTERED\"\r\n                                                                        ? <div style={{\r\n                                                                            color: \"green\",\r\n                                                                            border: \"1px solid green\",\r\n                                                                            padding: 3,\r\n                                                                            borderRadius: 5\r\n                                                                        }}>{value}</div>\r\n                                                                        : column.id === \"status\"\r\n                                                                        && value === \"REJECTED\"\r\n                                                                            ? <div style={{\r\n                                                                                color: \"crimson\",\r\n                                                                                border: \"1px solid crimson\",\r\n                                                                                padding: 3,\r\n                                                                                borderRadius: 5\r\n                                                                            }}>{value}</div>\r\n                                                                            : column.id === \"status\"\r\n                                                                            && (value === \"CLOSED\"\r\n                                                                                || value === \"CLOSED_WITH_ACT\")\r\n                                                                                ? <div style={{\r\n                                                                                    color: \"black\",\r\n                                                                                    border: \"1px solid black\",\r\n                                                                                    padding: 3,\r\n                                                                                    borderRadius: 5\r\n                                                                                }}>{value}</div>\r\n                                                                                : value}\r\n                                                        </TableCell>\r\n                                                    );\r\n                                                })}\r\n                                                <TableCell>\r\n\r\n                                                    <Tooltip title=\"Click to see invoice info\"\r\n                                                             arrow\r\n                                                             className=\"table-delete-edit-div\">\r\n                                                        <Button\r\n                                                            className=\"menu-table-btn\"\r\n                                                            color={\"primary\"}\r\n                                                            startIcon={<VisibilityIcon/>}\r\n                                                            onClick={(e) => {\r\n                                                                e.stopPropagation();\r\n                                                                handleTableRowClick(invoice)\r\n                                                            }}/>\r\n\r\n                                                    </Tooltip>\r\n                                                </TableCell>\r\n                                            </TableRow>\r\n                                        );\r\n                                    })}\r\n                            </TableBody>\r\n                        </Table>\r\n                    </TableContainer>\r\n\r\n                <TablePagination\r\n                    rowsPerPageOptions={[10, 20, 50]}\r\n                    component=\"div\"\r\n                    count={totalInvoicesAmount}\r\n                    rowsPerPage={rowsPerPage}\r\n                    page={page}\r\n                    onChangePage={handleChangePage}\r\n                    onChangeRowsPerPage={handleChangeRowsPerPage}\r\n                />\r\n\r\n                    <WaybillDialog\r\n                        invoice={invoice}\r\n                        open={waybillDialogOpen}\r\n                        onClose={() => {\r\n                            setWaybillDialogOpen(false);\r\n                        }}\r\n                        onSave={() => {\r\n                            fetchInvoices(false)\r\n                                .catch((err) => {\r\n                                    setInvoices([]);\r\n                                    handleRequestError(err);\r\n                                });\r\n                        }}\r\n                    />\r\n\r\n                    <DialogWindow\r\n                        dialogTitle=\"Confirmation\"\r\n                        handleClose={handleClose}\r\n                        openDialog={waybillFillDialogOpen}\r\n                        form={form}\r\n                    />\r\n\r\n                    <DialogWindow\r\n                        dialogTitle={\"Invoice # \" + invoice.number}\r\n                        fullWidth={true}\r\n                        maxWidth=\"xl\"\r\n                        handleClose={handleClose}\r\n                        openDialog={invoiceInfoDialogOpen}\r\n                        form={form}\r\n                    />\r\n\r\n                    <InvoiceDialog\r\n                        invoiceId={selectedId}\r\n                        open={invoiceDialogEditOpen}\r\n                        onClose={() => {\r\n                            setInvoiceDialogEditOpen(false);\r\n                            fetchInvoices();\r\n                        }}\r\n                        openToast={openToast}\r\n                    />\r\n                </Paper>\r\n                {ToastComponent}\r\n            </main>\r\n    );\r\n});\r\n\r\nexport default InvoicesTable;\r\n"]},"metadata":{},"sourceType":"module"}